from fasta.Fasta import read_fasta
from collections import defaultdict

visited = defaultdict(list)

def node_exists(left, right):
    return (left[2] in visited.keys() and right[1] in visited.values()) or (right[2] in visited.keys() and left[1] in visited.values())

if __name__ == '__main__':
    data = '''
>Rosalind_3720
TACATTGGATGACTATTTTACATTTAAAATTCCCTCACGGGCGTTCTCGGGCCATACAGA
CCACAGAGTCATGTCTTGTGTCACAT
>Rosalind_0112
TCATGTATGGGTAGACCTGTTCCTGGCGCGTGCTTACTCAACTCTGCGAAGGATCTAAGC
ACTTGGATGTGATTACCTCAAGGTCGTGTGCCCGAG
>Rosalind_7382
CCGCTCTCCTTCATATCTTACCCAGTCTCCTATAGAATATTTAAGTGCGCGACGGGGGAC
CCCCAAGGCTGAATTCTCTACATTACCCATCTGAA
>Rosalind_9595
CACCGTGTTCTAATCCATTCGTGGTGCAGTAGCCATTATGGTGATGTGCCATACCAAGTA
TTGTGCCAAGATACATCCTTTTGGACGTAACGCTA
>Rosalind_7805
GCAAATAGATAACCGGCCGTTAGGTCTATTCGGCGGCCTTTCCACGATGTGCGCGGCAGC
TTCTCGTGAATAAACCGGGCGTAATGA
>Rosalind_2084
AGCCGAAATCAGCGGATTACCCGTGAATATAGGATACTGCAGGTCAGTGAGCTGGCTCCA
GCACCAACGCATTAGCGATGTTCGCT
>Rosalind_4453
ACCTAATTTTTCTACAGCCCGTGCGTTTGTTGCTAAAGATCCCCTGGCAAATGAAGGAGT
ATCTCTACGGCGGCATACGCGTAGCGAAGTTG
>Rosalind_5672
TTGCGTCAACGCAATTAACTAGGGTGACCTTCGGGCTGCGCGCGTCAGTTTTGAAAGCCG
ACATTCCGTTTTCTACTCTTCAGAT
>Rosalind_8843
ACCAGTTGCTCAGTTTAAGCATCGGGTATATGGTAAACGCGGTGATTGTCATGTTGTCTT
GACACGCCTAAAGAAAGAAAAGTGGGTTCCGTC
>Rosalind_2816
CGCCATCATAAAGGATCTAACACCAACCAGTGTAATTCGAGCTATAGGGTATAACGTAAG
CATCGCCACCACAAGCTTCATAATAGGTGCGGGTTAAAT
>Rosalind_2031
GTTTCTGCTTCATTGATGTGCGTCACTTTCCGCGCGGGACATAAGCAGGTACATTTTCGA
CGTACAAGCAGGCGCATTCCAGATTGAATCTGGGTA
>Rosalind_5715
CCCGCTATTCTCAGAGGGCGGCCCGACACATTAGAACCGTTACAGGGGTCGTTCCTTGGT
AGGTACTAATCTCCTAATCTACGCCTGCTT
>Rosalind_7884
GTTCCTACTCCAACGAGCACATTGACGGTACTTGATTGCTCCTAAACTCTTGGTCGCCTG
TTTGTCCTTTGCTGCTAGTGGGCTCGTCATAAACTGTG
>Rosalind_6861
ATTCCGGCCTTCATCTTTCTATTCACAAAGTTTCCCTGGCGGTCGGAGGTGAACACCTGA
GAGTGGGGATGCCGACCAAGACCTAACC
>Rosalind_3378
CCCTAGGATGGACATGTACGTGCACTGAATCTCCCAGTGCTATGAGAAGTTTCTTATGCA
AGTCAGCAAATATCCATTCCCCC
>Rosalind_4079
GTCAGGCCAAATCGTCGTGGGCTGCTCGCAACGGCTTAGGTTTAGACCTTGACACTCTTG
CCCGGTTAATAGGTTCCGCGTAGGCCTCACGAAGTTTAAA
>Rosalind_4091
ACACAAAATGACTTGGAATATACACGATGCGGGAATGCGACGCATCAAGAAGATGTTTAT
TCCTGATCCTGGTCTTCCTCCTTTGTAT
>Rosalind_6083
CTATCTTATACCTACCGATGTTTGTCCTTCTCTGCCCGTAAAGCCGGCCTTGGGAAACAG
AAAAATTTTGTTGAAAGTCTACAGCTCTACATCTGGCT
>Rosalind_5919
CTTCTGTCATCTATATAAGGCCAATGGTCGGGCGCGCACGCTAAATTACTCCTCCGTGGG
GTCGTACGCAGGAAGTCTTGCT
>Rosalind_4441
ATCTCCTGGGCTAGAAGGAACCCACGTAGTAAGACTCTCAAGCGGTTCTAATTTCGGAGT
TTAAAGTGATGAGGAAGAACCATTGAGAGCGGGT
>Rosalind_9865
CACTCATTTGTCGAAATAGTACAAGACGTAAAGACTGGTCGACGCTTGAGACACCCTAGC
TCTTGTGGGAATCAGGGGCTCATTACCATTAAGCTTAG
>Rosalind_8737
AATGTCAGAGTGGCGGACCCACTTGCCGCAGTACTCTGGGTCTTATTAAGACCCGCGTCC
GCCAGTCGCTAGATCATCAAGAGCTGACGTCCACCAGG
>Rosalind_2453
TTGCGCGAGTTGACTTATGACTCACCCGCCCCGCATACACAGGACGCGTTCCCTGACTTG
GGATACTTAATTCGGTGGAAGG
>Rosalind_2562
GAAGAAAGCCACGGGATGATCATCCACAGAACAGCAGGGCACTACGCCCCTCGACTATGT
TCTCGACTAGGACCGGGCCGAA
>Rosalind_0537
GCAACACGACCTGAAGTGTGGTCCACTGGTTCTGCGATTCTATTCTCTCTTGCCTAGTCA
TGCAACAAGCTCCTAATACAGCAGTACACATACGTCG
>Rosalind_6200
GAGGATTCCCACTTGTGCCACCAATCCTAAACTTCCGCGTACGTTTTAGTAATCGCATTA
CCTTTGAAACCAAGATTTTTCAACTGACCC
>Rosalind_9044
CCCACAGTCTCTACCACATTCAATGCTGGCGGCGTACATGAGTCCTCCTCCTTGCCTGAT
CACGGCAAATAGTAGATCTTACGAGTCTTG
>Rosalind_9195
CTTACTTCTAAGCAGCCCGTATAGATGTAATTTCAGTGCGGGACTACCCCATGGTTGTCG
TGGATCGAAGCTTTGGTCGAGGTACTCTTCA
>Rosalind_7985
GCTTTCAAATATCAGATGCAACCCTGGCTTTTACTCCGATCTTTTGCGACATAAATGTGG
CCTCGTATACAGGTCTAAGTTTTATCATGCTCC
>Rosalind_5705
CACCCAATAGCTGTAAAACAGCTTATTGAAAAATAAGCCTGACTGCCGATGGAACGATTA
ATGATAACCCTTCGAGGTGTATATGTCTCCAA
>Rosalind_4109
TAATCGGAACTCCGGGATGAGGAGAGAGTGTCCTCTATCAACGGAAGCGGCTCGATTCCC
GCTGACAGACGGGATGCTAACAGGGAGGCCGGAGACGACT
>Rosalind_2570
GAGGAGAGAACTATTTTCGTCCTAAACGCTACTAATCCACCGGCAGCTGCTACGTTAGAT
TTTGCAGTTCTCTCCCCTTCGGGCGCGACCTCAATGAC
>Rosalind_9956
AAAAATGGATGTAGCACCGGCTCCCTAACCAGATAAGAAGCACAGAGTTCGTTCTGCGTC
AACATTTCGTGTAAATTGGGCATATC
>Rosalind_9263
CCAATTTCGACTGGGAGTCCCTACTGCGTCACATAGCGTACGCGGAGCACGGGGGGAGAA
GTCCCCAGCCGGGGTTACCACCGTAATATCGGCCACCTC
>Rosalind_7008
CAAATCTGTCAATGAACGTGATGGGATTGAGTCCGAAGCGCCCAAGTCCGGGGAGACACT
CCGCCTGTAACCCAGGGCTATGT
>Rosalind_5587
CTTTACTTCCTGGCAGGATCTGGCGTGGACGAGGCGAGACACTTTTTCAGGACGTAGGAC
AAATAGGGTAGGGGAGAGAGCTGCCTTTTCCTCCTTCCCC
>Rosalind_7154
AGCGCTGAACAGGTGGCGCTTTGGGGTGACGGGCTCGTTGCTGTTGGAGGCCACCGTGAG
GCAATCTTACGCAGTGAACA
>Rosalind_1393
GCCTCTATAATCTTAGTTGCGGCTACCTGCTTTTTCACTTAATGTCACGCTATAATATTT
TTCTCTAATCCCACTCTTGACGA
>Rosalind_2611
TGACCGAGATTTAGCCACATATCAATATACGTTTCAAATACAACAAGCACGGTGAACGCT
CGCCTAGTCAGTCCGTGGAGCCGGAG
>Rosalind_5200
GGCGTCCGTACACGCTGGCGGACATAGTGCATTGGGACCGTTTTTAGCGACGCTTTTGGT
TGTAACGGATGAGCATTGTTACGCCCGACAAG
>Rosalind_6937
CAGATTGTACAGCGACACAAGAAGCCCTACGCTCACTGCCTAATGAGTCGATGTCAGCTA
TTATGATCGCACACTCATCGGTAGTAAACATCTC
>Rosalind_1137
TACCCTCGTCACGGCAGGCACCGTCCTTAGTGTACAGTAGTGACGATAGGGCCCAGATGT
TGCTACAATTCTACGGTGTCCCCTTCGTGTGAG
>Rosalind_6151
TCCCATCCATTGAGAGCTGTAGATTAGTCGGTAGGTATCCATACGAAGTGTAACACAGGC
GGACGCTTTCGTGCCTATTAGGTAGACCCCATGCAGC
>Rosalind_3963
GGGGATAGCACCGTGCTGACGCGGTCTGCTCTATAACATTGCTCGAACTGTCGGGGACAC
GGCGCTGGCCCTACCAAAACTTG
>Rosalind_4147
CCGGTTCGCTTCAGAATCTGGCGGTAGATTAACATCGTGTAAAATCGGTGGTTTCCCTTG
GTTAAACAGCCAAAGCGCTGG
>Rosalind_4538
AAGGATTCATGCTGAGTTGGACTCTAATCATCAATCGGCGGTCTGTAGTTGCTCACATGT
CGCCTCACCGACGAGCTGGGCCTC
>Rosalind_4203
GTGTTGACCGTATGAGTGGTGGTGTTCAATCTAATTCGTACATACACTGCGTTGCGTGCA
CCCGTCATTGACGTGCCTACATCA
>Rosalind_4034
TTGGTTGTACTCACGTGTACCTGGATACGTACTGACGGAGCCTTACCGAGTACAGCGGTA
GAAAGTATGTTATGTTATCACAAATATCTCT
>Rosalind_4557
AGACGATAGCGTAGTGATGGTGGTTTTACTCACGCCCCATCTCGTAACAAGGGCACTTGA
AGCACAGCTAATTGCCGATTCGAGCGAAACCGCG
>Rosalind_9849
GGCCTGAGGTATCTACACCCGAGAGGAGGGCCCTCTTAGTTGCAGGTCGAGGGGGGTAGG
ATCCGATAAGCCGAACATGA
>Rosalind_7877
TTCTAACAGACCCCCCGATCCTCCATGCTGGAGTCTTACCCGGCGTAGGGGCGGTGGAGG
ACCTACCCAGAGTATAGGAGCAACCGAGCCGA
>Rosalind_1871
CACAGCAAGCGTTGTCCCGCGATAGGCTGACGGTATCGGGTAACCTCGAGGCGAGACAGG
AAGCAAACTGCACCGCTGTCGCTGCAGTACTGGG
>Rosalind_0618
GACTCGGCATGGCCTCATATTACACGTCCATCTTGATTATCTAGGTATGGTACACTATCC
GGTCAGCATTAGTTGTTCAAAAGCCCGGATTG
>Rosalind_6547
CTCCTTCGATTCGGTGGCTGCCCCAGCATCTGAATCCTTCAGGGAGCATGACCTATGAAA
CAACACGTCAAGGGCGCGGGGATCTTT
>Rosalind_0382
CTTCCAGGGGTGGGCCGGACATGGATAACACTCAATCATGAGCAAGGTAGGATTGGCTCC
TCAGCTCCATGGGAGGCACGGTAACGAGGTGTCTGTTC
>Rosalind_0083
CACTCTGTCAAGTAACTGTAACCACACTCCTCTTGTCATGTGTAGGCGTACCTCCAAGTT
ATTCAGGGACTGCCGTCTCC
>Rosalind_2206
CAAGTAGTTCAATTATCGATGATACGCAGGTGAACTATCTAGTGAGGTCTGTTACACGTA
GGTCTATAGGGCCACGCGCACCTCGAG
>Rosalind_1099
TTACTGTTTGGACCTCAGACGGCGTTTGATACCCTCCGTCTTGCCCCGGAAGCTACGCTA
GTCGTATGCAAACACGCTTGATTATAGCCATCCTGT
>Rosalind_5081
CTAGAATAAAACCACTCTTGACTCGATTACGGGGGCAGTGAGTAGCTGCGACTAACACGT
CACGAGGTCTTCGACTGAAA
>Rosalind_8507
CTACGGTGCGAGGCCTGAATATGTTCTGATCGTTCGGGGACGTGGAGTGTCACTGACGTG
CAGATATAGCACACTTTGATTGTTATAGGTGTC
>Rosalind_7301
ACTATGGGTCTGAAAGCGCGTACGTACCAACCGCCTTTGCGCAGCCCAGGTAGAGACAAT
TTAAGGAATTTACCAAGTCTT
>Rosalind_2636
TGCAGGCTAGGCCGATCAATTCCTATAAATGGAAAAAGACCCCACCACAACGCGGTAACC
GGAACATCTTAAGATTCCTTCG
>Rosalind_8880
TTCACGGTACTACACCCATAGCCATACCGTCCTGTTAGACCAATTGCCGTTTGGATAGGG
TTTCCTGTGATTGGTAGAGAAGGGTCCAGTCT
>Rosalind_7075
TATTCTTTTCGTAATTATCCTGCTTAATGTGGTTACCCAGCCCAACTATGGAAATCTGAC
TAGCGACGCCGTCAGACGTTACATGCCTACCCG
>Rosalind_3238
TTTCGCCCGACTCTTAGTTTGTAGCAACCCGCGTGCTTAAGGTTAATAATTGACGAAAGA
ATTCCGTGGATAAACGAATCACATCAATTCGCCAT
>Rosalind_2465
CCGGTGGACAGTTAACTTTTCAACCGGGATTCTGTCGCCTGACGAGACTTGAGTGGCACC
AAATATTCTCGCGTGGATACCAGACCACTATGTTTTCGCA
>Rosalind_0860
AGCCAAGATGTTACCAGTCGAGGGCGGCAACAAGGGAGATCGGTCAATAATTCGGTGTAA
AGACCTGCAAAGCATGATCT
>Rosalind_8808
CTAAAATCACGAAGACCATGTAGCTCTACAGGGGCAATAAGCCAACACCTCGCAGCATGT
GGAACATGGTAGACGCGATTTCATTCATGTACAGCT
>Rosalind_1885
TCCAGGTAAGGAGTGCCTATTACAGTCCTGTTGAGTTGCAAACCACCGACACCTGTGTAT
TCTATTTCGAGTAGAGGAATATTTTCAAAC
>Rosalind_5091
AGCTGCCTTCTTTCTGTACGGTCCCAGATATCAAGGTCGAGGATCCTATATACGAACAAA
CGGAATGCTAGACTGTGGTGTATGCATCCAAAGGCT
>Rosalind_1908
CAACTATTTTTATCGTTTTGATCTAGAACTAAGACCGAGGATCCTCCTGAAATGTCACGA
CGCTAGGGGAGGGGTCGATGCCCCCCTATATAGTGTTTTT
>Rosalind_2246
GAGATCCCGGTCGGTCCCGACCCGCTACTACAACCACATAAGTCCTTGGCGTTCCGCCAT
GTATACAGCATCACTGTACACTCGTA
>Rosalind_9875
TGGCGGTTACTCCCCAACTTCTTTCATACTTGCGATGCGTTTAGTAATTCTTGTGCTTGT
CTAAAGCATGTCAAGCACTGGCCGTC
>Rosalind_2038
CCGGCCACAGCGAGTCTCGTTTCCCAGTCGTCCTTTTTATAGCCTGACTTTTAGGCCCGA
CGATGCTACACTTCCTAAGCAGATT
>Rosalind_3093
GTGAAGAGGTATATGGACGTCTGGAACGTGAGTGGCAAATCCTCTTACAAAAGTCGCACA
GTTGAATTCGGTTTAGCAACTCGGCCTC
>Rosalind_5409
CATTCCGTCTTTCTAAAAATTTTCGCTGTGCCCGTTTATCTTGACATTCACCCGTCAGGA
GTATATTCTCGAGAACGCCGTCGAGTTTCGGTGGAT
>Rosalind_4603
ACACAGGTCACCTACACCATGCTTTACTTAGATCCGCGGCTCGTCCAATTTAACAGTTAG
GGACTGCGCCATCCTCGCAATAACGCGGGTGGGCCACC
>Rosalind_8299
GCCCCATTATTCCTCCTAATGATCCCCTGGGGCCAGGTGTTTCCACTGTACACTTAGCCG
TTTCCTAATTTATAGGACGATGTCACCCTGCTCTCAT
>Rosalind_9159
TACACTTGCACGGTCGTTTTGATCGTACGCCGTCCATTGGAGAAGGGGATATCGTTGAAT
CCTCACAAGGAGAACATTTTTGAATGCGAGCGCTCACG
>Rosalind_9864
ATATCGCTCCCGCTAAGAAGTAAGAATTACTGGCAACCGGTGCAAGTACAATGACACAAG
CTATGGACTTTAGCTAGAAATTGGGCGCCAGTACTT
>Rosalind_3330
CCATGGTATGGTTCCCGATAGATCCTCCGTAATCCCGAGATGTACCAGCATGCAAGAATC
GCAAGAGAAGCTCAAATTATGAC
>Rosalind_1670
CATCCCTAGGACCTGATACTAGGTTTTTCCCGCTGTGTGCCCGACGTTACGGGGTTAGAA
ACGTGTCCTACGTTCTCATAGCGCGAGAGTCTA
>Rosalind_6275
GTTATGACGATGACTATTCTACACAGGCCAGACGCACAGATTAGACTATCTTTTATATGT
ACATACTGTGAACATCGCCGC
>Rosalind_5664
CTTTCAACCTGTGATCCAAGAAGGTACCTTCCGGTCACTGCCCATGAGACATTGCTAATC
CCACAGTACGTAGTACTCTGCCTAAACGAAAGTT
>Rosalind_2698
AGACGCTGGAGTTGCCTACGCCTACGTGTGAACCTTTTCCGACGACGCCGCGGTAAGCCC
AGGTTGACGGCGACGCGAGAGTGGTGG
>Rosalind_6460
AGCAGGACTTGGGCGCGTCAAAATATAACGATAGTTCAGCTCCACCCTCGACTTCCCAAT
AATGCATCCCTGGTCTGCCAAATCGACCAAGA
>Rosalind_9486
CGCGCTTACAGTTCGTCGTGAGGCGTTCGCTATGCGAAAAAGACCTTCCCGAAATTGGTC
AGATAGTGTTCCCTTCCCATAG
>Rosalind_5834
ACTACTCGGGGGGAATTCAGCGGCAATTAATAATGTTTTCCCCACACGTCTTGCTCGATA
TCACCGGATTACCTAGCCTTCATTAT
>Rosalind_7959
TCCTGTCGGCGTCATGCCGAGATTTCCCCGAGCTGGGTGCTAGAATTAAGGTTGTTCAGT
ACTGGCGTTACGAAAAGTAGGACCTACATTAC
>Rosalind_1701
AGTGCTCTTTCACTTCCGTTGGGAACGTCACATACATGTGTTCTGGGGTCTGATCAATGG
GAGAGCGCGAATGTGGCTCAG
>Rosalind_5197
AGAACTTCTCCGGTGAGGCTATCAGTCGCAGCATCTGCTGTCGGTCAGTTTACGTCGCAT
GCCACTGTAGTACTAACGCGGATTTTAGGAAGTGGGGGA
>Rosalind_5237
TATTTTTACTAGTTGGGAAACTTTAGATAGTACTAATGGACGGCGGTGGGCTTGGGGCTC
AGACACCCGCTTTCGTACCAGCTCAAGCTTAAAG
>Rosalind_7740
GGTCCCCCGTTTTTATGCCATAGTACCGTTAAGGCGACTACATTATGCTTCGGGCCCTTT
CTACAGATAAAGAGGCCTTACCTATAACGCGACACCG
>Rosalind_8293
CTATGTCACCAAAAATACGGTACTCAGGGAATGGTACCGCACGATAGATTCGAGTCCCCG
ACCTGAGAGAGAATTGTTCCCTGCGCCCTGTCTGACC
>Rosalind_0457
ATATGCGCGGATAAGACCAAACTGGAGTATTAGAACGTTCCAACGATCGCTTGGTGACGG
TCAGATCCGCACGGGCCCGAGTATCAC
>Rosalind_7035
CGATCTTGATGTGTTACCATGATGAATGTCATCAACTCTTCGTTAGCAAGAAAAAACTAC
CATCCAGCCTGGCTCATGGTTTTCCGTAA
>Rosalind_4921
TGCAGCGCGGCACGGAATGAGACCCGACGTACACTTATCGGTGCTCGCAACCGTTTCCAA
GATCCACCACACATCCAACCAAACTTGAGTGTGT
>Rosalind_8741
GAATGTGCAAGCAAAGTAGCCGGCACGGAATGTGTACCCTCGTTTAGGTCGGATATCTGA
CTTATTTGCGAAACCGAGTCAACCATGACCG
>Rosalind_9396
CGGATATTGGATGGCTATTGCCCGATATGGCTCTGGACAAGTGAGTACCGGGCCTCACTA
ACACGGTGGTGAATTATAATCTCGTA
>Rosalind_5617
GAGCCAGCCTAGTTCGGGATTGATTCACGTTTAAATGTACGGGGCGGTCCTGTATGTCAC
AACTATGTAGGTAAATACACGTGGTGGTTGGATAGAGGCA
'''
    seqs = read_fasta(data)

    graph = list()

    for s in seqs:
        sequence = s.sequence
        name = s.name

        left = sequence[0:3]
        right = sequence[-3:]

        graph.append((sequence, left, right, name))

    for i in range(len(graph)):
        e = graph[i]
        for j in range(len(graph)):
            f = graph[j]
            if (e[3] == f[3]):
                continue
            #print 'comparing', e[2], f[1]
            if (node_exists(e,f) == False):
                if (e[2] == f[1]):
                    visited[e[3]].append(f[3]);

    for key, value in visited.iteritems():
        for right in value:
            print key, right